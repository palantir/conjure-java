package com.palantir.another;

import com.google.common.reflect.TypeToken;
import com.palantir.conjure.java.undertow.lib.BinaryResponseBody;
import com.palantir.conjure.java.undertow.lib.Endpoint;
import com.palantir.conjure.java.undertow.lib.EndpointRegistry;
import com.palantir.conjure.java.undertow.lib.Registrable;
import com.palantir.conjure.java.undertow.lib.SerializerRegistry;
import com.palantir.conjure.java.undertow.lib.Service;
import com.palantir.conjure.java.undertow.lib.ServiceContext;
import com.palantir.conjure.java.undertow.lib.internal.Auth;
import com.palantir.conjure.java.undertow.lib.internal.BinarySerializers;
import com.palantir.conjure.java.undertow.lib.internal.StringDeserializers;
import com.palantir.product.AliasedString;
import com.palantir.product.CreateDatasetRequest;
import com.palantir.product.NestedAliasedBinary;
import com.palantir.product.datasets.BackingFileSystem;
import com.palantir.product.datasets.Dataset;
import com.palantir.ri.ResourceIdentifier;
import com.palantir.tokens.auth.AuthHeader;
import io.undertow.server.HttpHandler;
import io.undertow.server.HttpServerExchange;
import io.undertow.util.HeaderMap;
import io.undertow.util.Methods;
import io.undertow.util.PathTemplateMatch;
import io.undertow.util.StatusCodes;
import java.io.IOException;
import java.io.InputStream;
import java.util.Deque;
import java.util.Map;
import java.util.Optional;
import java.util.OptionalDouble;
import java.util.OptionalInt;
import java.util.Set;
import javax.annotation.Generated;

@Generated("com.palantir.conjure.java.services.UndertowServiceHandlerGenerator")
public final class TestServiceEndpoints implements Service {
    private final TestService delegate;

    private TestServiceEndpoints(TestService delegate) {
        this.delegate = delegate;
    }

    public static Service of(TestService delegate) {
        return new TestServiceEndpoints(delegate);
    }

    @Override
    public Registrable create(ServiceContext context) {
        return new TestServiceRegistrable(context, delegate);
    }

    private static final class TestServiceRegistrable implements Registrable {
        private final TestService delegate;

        private final SerializerRegistry serializers;

        private TestServiceRegistrable(ServiceContext context, TestService delegate) {
            this.serializers = context.serializerRegistry();
            this.delegate = delegate;
        }

        @Override
        public void register(EndpointRegistry endpointRegistry) {
            endpointRegistry
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/fileSystems")
                                    .serviceName("TestService")
                                    .name("getFileSystems")
                                    .build(),
                            new GetFileSystemsHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.POST)
                                    .template("/catalog/datasets")
                                    .serviceName("TestService")
                                    .name("createDataset")
                                    .build(),
                            new CreateDatasetHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/datasets/{datasetRid}")
                                    .serviceName("TestService")
                                    .name("getDataset")
                                    .build(),
                            new GetDatasetHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/datasets/{datasetRid}/raw")
                                    .serviceName("TestService")
                                    .name("getRawData")
                                    .build(),
                            new GetRawDataHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/datasets/{datasetRid}/raw-aliased")
                                    .serviceName("TestService")
                                    .name("getAliasedRawData")
                                    .build(),
                            new GetAliasedRawDataHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/datasets/{datasetRid}/raw-maybe")
                                    .serviceName("TestService")
                                    .name("maybeGetRawData")
                                    .build(),
                            new MaybeGetRawDataHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/datasets/{datasetRid}/string-aliased")
                                    .serviceName("TestService")
                                    .name("getAliasedString")
                                    .build(),
                            new GetAliasedStringHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.POST)
                                    .template("/catalog/datasets/upload-raw")
                                    .serviceName("TestService")
                                    .name("uploadRawData")
                                    .build(),
                            new UploadRawDataHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.POST)
                                    .template("/catalog/datasets/upload-raw-aliased")
                                    .serviceName("TestService")
                                    .name("uploadAliasedRawData")
                                    .build(),
                            new UploadAliasedRawDataHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/datasets/{datasetRid}/branches")
                                    .serviceName("TestService")
                                    .name("getBranches")
                                    .build(),
                            new GetBranchesHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/datasets/{datasetRid}/branchesDeprecated")
                                    .serviceName("TestService")
                                    .name("getBranchesDeprecated")
                                    .build(),
                            new GetBranchesDeprecatedHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template(
                                            "/catalog/datasets/{datasetRid}/branches/{branch:.+}/resolve")
                                    .serviceName("TestService")
                                    .name("resolveBranch")
                                    .build(),
                            new ResolveBranchHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/datasets/{datasetRid}/testParam")
                                    .serviceName("TestService")
                                    .name("testParam")
                                    .build(),
                            new TestParamHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.POST)
                                    .template("/catalog/test-query-params")
                                    .serviceName("TestService")
                                    .name("testQueryParams")
                                    .build(),
                            new TestQueryParamsHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.POST)
                                    .template("/catalog/test-no-response-query-params")
                                    .serviceName("TestService")
                                    .name("testNoResponseQueryParams")
                                    .build(),
                            new TestNoResponseQueryParamsHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/boolean")
                                    .serviceName("TestService")
                                    .name("testBoolean")
                                    .build(),
                            new TestBooleanHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/double")
                                    .serviceName("TestService")
                                    .name("testDouble")
                                    .build(),
                            new TestDoubleHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/integer")
                                    .serviceName("TestService")
                                    .name("testInteger")
                                    .build(),
                            new TestIntegerHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.POST)
                                    .template("/catalog/optional")
                                    .serviceName("TestService")
                                    .name("testPostOptional")
                                    .build(),
                            new TestPostOptionalHandler())
                    .add(
                            Endpoint.builder()
                                    .method(Methods.GET)
                                    .template("/catalog/optional-integer-double")
                                    .serviceName("TestService")
                                    .name("testOptionalIntegerAndDouble")
                                    .build(),
                            new TestOptionalIntegerAndDoubleHandler());
        }

        private class GetFileSystemsHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                Map<String, BackingFileSystem> result = delegate.getFileSystems(authHeader);
                serializers.serialize(result, exchange);
            }
        }

        private class CreateDatasetHandler implements HttpHandler {
            private final TypeToken<CreateDatasetRequest> requestType =
                    new TypeToken<CreateDatasetRequest>() {};

            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                CreateDatasetRequest request = serializers.deserialize(requestType, exchange);
                HeaderMap headerParams = exchange.getRequestHeaders();
                String testHeaderArg =
                        StringDeserializers.deserializeString(headerParams.get("Test-Header"));
                Dataset result = delegate.createDataset(authHeader, testHeaderArg, request);
                serializers.serialize(result, exchange);
            }
        }

        private class GetDatasetHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                Map<String, String> pathParams =
                        exchange.getAttachment(PathTemplateMatch.ATTACHMENT_KEY).getParameters();
                ResourceIdentifier datasetRid =
                        StringDeserializers.deserializeRid(pathParams.get("datasetRid"));
                Optional<Dataset> result = delegate.getDataset(authHeader, datasetRid);
                if (result.isPresent()) {
                    serializers.serialize(result, exchange);
                } else {
                    exchange.setStatusCode(StatusCodes.NO_CONTENT);
                }
            }
        }

        private class GetRawDataHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                Map<String, String> pathParams =
                        exchange.getAttachment(PathTemplateMatch.ATTACHMENT_KEY).getParameters();
                ResourceIdentifier datasetRid =
                        StringDeserializers.deserializeRid(pathParams.get("datasetRid"));
                BinaryResponseBody result = delegate.getRawData(authHeader, datasetRid);
                BinarySerializers.serialize(result, exchange);
            }
        }

        private class GetAliasedRawDataHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                Map<String, String> pathParams =
                        exchange.getAttachment(PathTemplateMatch.ATTACHMENT_KEY).getParameters();
                ResourceIdentifier datasetRid =
                        StringDeserializers.deserializeRid(pathParams.get("datasetRid"));
                NestedAliasedBinary result = delegate.getAliasedRawData(authHeader, datasetRid);
                serializers.serialize(result, exchange);
            }
        }

        private class MaybeGetRawDataHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                Map<String, String> pathParams =
                        exchange.getAttachment(PathTemplateMatch.ATTACHMENT_KEY).getParameters();
                ResourceIdentifier datasetRid =
                        StringDeserializers.deserializeRid(pathParams.get("datasetRid"));
                Optional<BinaryResponseBody> result =
                        delegate.maybeGetRawData(authHeader, datasetRid);
                if (result.isPresent()) {
                    BinarySerializers.serialize(result.get(), exchange);
                } else {
                    exchange.setStatusCode(StatusCodes.NO_CONTENT);
                }
            }
        }

        private class GetAliasedStringHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                Map<String, String> pathParams =
                        exchange.getAttachment(PathTemplateMatch.ATTACHMENT_KEY).getParameters();
                ResourceIdentifier datasetRid =
                        StringDeserializers.deserializeRid(pathParams.get("datasetRid"));
                AliasedString result = delegate.getAliasedString(authHeader, datasetRid);
                serializers.serialize(result, exchange);
            }
        }

        private class UploadRawDataHandler implements HttpHandler {
            private final TypeToken<InputStream> inputType = new TypeToken<InputStream>() {};

            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                InputStream input = BinarySerializers.deserializeInputStream(exchange);
                delegate.uploadRawData(authHeader, input);
                exchange.setStatusCode(StatusCodes.NO_CONTENT);
            }
        }

        private class UploadAliasedRawDataHandler implements HttpHandler {
            private final TypeToken<NestedAliasedBinary> inputType =
                    new TypeToken<NestedAliasedBinary>() {};

            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                NestedAliasedBinary input = serializers.deserialize(inputType, exchange);
                delegate.uploadAliasedRawData(authHeader, input);
                exchange.setStatusCode(StatusCodes.NO_CONTENT);
            }
        }

        private class GetBranchesHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                Map<String, String> pathParams =
                        exchange.getAttachment(PathTemplateMatch.ATTACHMENT_KEY).getParameters();
                ResourceIdentifier datasetRid =
                        StringDeserializers.deserializeRid(pathParams.get("datasetRid"));
                Set<String> result = delegate.getBranches(authHeader, datasetRid);
                serializers.serialize(result, exchange);
            }
        }

        private class GetBranchesDeprecatedHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                Map<String, String> pathParams =
                        exchange.getAttachment(PathTemplateMatch.ATTACHMENT_KEY).getParameters();
                ResourceIdentifier datasetRid =
                        StringDeserializers.deserializeRid(pathParams.get("datasetRid"));
                Set<String> result = delegate.getBranchesDeprecated(authHeader, datasetRid);
                serializers.serialize(result, exchange);
            }
        }

        private class ResolveBranchHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                Map<String, String> pathParams =
                        exchange.getAttachment(PathTemplateMatch.ATTACHMENT_KEY).getParameters();
                ResourceIdentifier datasetRid =
                        StringDeserializers.deserializeRid(pathParams.get("datasetRid"));
                String branch = StringDeserializers.deserializeString(pathParams.get("branch"));
                Optional<String> result = delegate.resolveBranch(authHeader, datasetRid, branch);
                if (result.isPresent()) {
                    serializers.serialize(result, exchange);
                } else {
                    exchange.setStatusCode(StatusCodes.NO_CONTENT);
                }
            }
        }

        private class TestParamHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                Map<String, String> pathParams =
                        exchange.getAttachment(PathTemplateMatch.ATTACHMENT_KEY).getParameters();
                ResourceIdentifier datasetRid =
                        StringDeserializers.deserializeRid(pathParams.get("datasetRid"));
                Optional<String> result = delegate.testParam(authHeader, datasetRid);
                if (result.isPresent()) {
                    serializers.serialize(result, exchange);
                } else {
                    exchange.setStatusCode(StatusCodes.NO_CONTENT);
                }
            }
        }

        private class TestQueryParamsHandler implements HttpHandler {
            private final TypeToken<String> queryType = new TypeToken<String>() {};

            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                String query = serializers.deserialize(queryType, exchange);
                Map<String, Deque<String>> queryParams = exchange.getQueryParameters();
                ResourceIdentifier something =
                        StringDeserializers.deserializeRid(queryParams.get("different"));
                Optional<ResourceIdentifier> optionalMiddle =
                        StringDeserializers.deserializeOptionalRid(
                                queryParams.get("optionalMiddle"));
                ResourceIdentifier implicit =
                        StringDeserializers.deserializeRid(queryParams.get("implicit"));
                Set<String> setEnd =
                        StringDeserializers.deserializeStringSet(queryParams.get("setEnd"));
                Optional<ResourceIdentifier> optionalEnd =
                        StringDeserializers.deserializeOptionalRid(queryParams.get("optionalEnd"));
                int result =
                        delegate.testQueryParams(
                                authHeader,
                                something,
                                implicit,
                                optionalMiddle,
                                setEnd,
                                optionalEnd,
                                query);
                serializers.serialize(result, exchange);
            }
        }

        private class TestNoResponseQueryParamsHandler implements HttpHandler {
            private final TypeToken<String> queryType = new TypeToken<String>() {};

            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                String query = serializers.deserialize(queryType, exchange);
                Map<String, Deque<String>> queryParams = exchange.getQueryParameters();
                ResourceIdentifier something =
                        StringDeserializers.deserializeRid(queryParams.get("different"));
                Optional<ResourceIdentifier> optionalMiddle =
                        StringDeserializers.deserializeOptionalRid(
                                queryParams.get("optionalMiddle"));
                ResourceIdentifier implicit =
                        StringDeserializers.deserializeRid(queryParams.get("implicit"));
                Set<String> setEnd =
                        StringDeserializers.deserializeStringSet(queryParams.get("setEnd"));
                Optional<ResourceIdentifier> optionalEnd =
                        StringDeserializers.deserializeOptionalRid(queryParams.get("optionalEnd"));
                delegate.testNoResponseQueryParams(
                        authHeader,
                        something,
                        implicit,
                        optionalMiddle,
                        setEnd,
                        optionalEnd,
                        query);
                exchange.setStatusCode(StatusCodes.NO_CONTENT);
            }
        }

        private class TestBooleanHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                boolean result = delegate.testBoolean(authHeader);
                serializers.serialize(result, exchange);
            }
        }

        private class TestDoubleHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                double result = delegate.testDouble(authHeader);
                serializers.serialize(result, exchange);
            }
        }

        private class TestIntegerHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                int result = delegate.testInteger(authHeader);
                serializers.serialize(result, exchange);
            }
        }

        private class TestPostOptionalHandler implements HttpHandler {
            private final TypeToken<Optional<String>> maybeStringType =
                    new TypeToken<Optional<String>>() {};

            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                Optional<String> maybeString = serializers.deserialize(maybeStringType, exchange);
                Optional<String> result = delegate.testPostOptional(authHeader, maybeString);
                if (result.isPresent()) {
                    serializers.serialize(result, exchange);
                } else {
                    exchange.setStatusCode(StatusCodes.NO_CONTENT);
                }
            }
        }

        private class TestOptionalIntegerAndDoubleHandler implements HttpHandler {
            @Override
            public void handleRequest(HttpServerExchange exchange) throws IOException {
                AuthHeader authHeader = Auth.header(exchange);
                Map<String, Deque<String>> queryParams = exchange.getQueryParameters();
                OptionalInt maybeInteger =
                        StringDeserializers.deserializeOptionalInteger(
                                queryParams.get("maybeInteger"));
                OptionalDouble maybeDouble =
                        StringDeserializers.deserializeOptionalDouble(
                                queryParams.get("maybeDouble"));
                delegate.testOptionalIntegerAndDouble(authHeader, maybeInteger, maybeDouble);
                exchange.setStatusCode(StatusCodes.NO_CONTENT);
            }
        }
    }
}
